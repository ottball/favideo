!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}n.r(t);var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this.getExistingFavicon();this.node=n||this.create()}var t,n,o;return t=e,(n=[{key:"getExistingFavicon",value:function(){return document.querySelector('link[rel="shortcut icon"]')}},{key:"create",value:function(){var e=document.createElement("link");return e.type="image/x-icon",e.rel="shortcut icon",document.getElementsByTagName("head")[0].appendChild(e),e}},{key:"update",value:function(e){this.href=e}},{key:"href",set:function(e){this.node.href=e},get:function(){return this.node.href}},{key:"size",set:function(e){this.size_=e,this.node.sizes=e+"x"+e},get:function(){return this.size_}}])&&i(t.prototype,n),o&&i(t,o),e}();function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=document.createElement("canvas"),this.ctx_=this.canvas.getContext("2d")}var t,n,i;return t=e,(n=[{key:"node",get:function(){return this.canvas}},{key:"ctx",get:function(){return this.ctx_}},{key:"width",get:function(){return this.node.width},set:function(e){this.node.width=e}},{key:"height",get:function(){return this.node.width},set:function(e){this.node.height=e}}])&&r(t.prototype,n),i&&r(t,i),e}();function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video=t,this.mode=n,this.favicon=new o,this.favicon.size=i,this.canvas=new a,this.videoEventListeners=[],this.enable()}var t,n,i;return t=e,(n=[{key:"update",value:function(){var e=this.mode.getFaviconFrame(this.video,this.canvas.node,this.canvas.ctx);this.favicon.update(e)}},{key:"enable",value:function(){this.mode.registerUpdateEvent(this)}},{key:"disable",value:function(){this.unregisterVideoEvents(),this.mode.disable()}},{key:"registerVideoEvent",value:function(e,t){this.videoEventListeners.push({event:e,func:t}),this.video.addEventListener(e,t)}},{key:"unregisterVideoEvents",value:function(){for(var e=0;e<this.videoEventListeners.length;e++){var t=this.videoEventListeners[e];this.video.removeEventListener(t.event,t.func)}}}])&&s(t.prototype,n),i&&s(t,i),e}();function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function f(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=f(this,v(t).call(this))).respectAspectRatio=e,i.fps=n,i.videoInCanvasSettings={dx:0,dy:0,dWidth:0,dHeight:0},i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),n=t,(i=[{key:"getFaviconFrame",value:function(e,t,n){return this.respectAspectRatio?n.drawImage(e,this.videoInCanvasSettings.dx,this.videoInCanvasSettings.dy,this.videoInCanvasSettings.dWidth,this.videoInCanvasSettings.dHeight):n.drawImage(e,0,0,t.width,t.height),t.toDataURL()}},{key:"getVideoInFaviconFit",value:function(e,t,n){var i=t/(e/n);return{width:n,height:i,offset:(n-i)/2}}},{key:"calculateAndSetVideoInCanvasProfile",value:function(e,t){var n,i=e.videoWidth,o=e.videoHeight;i>o?(n=this.getVideoInFaviconFit(i,o,t),this.videoInCanvasSettings.dx=0,this.videoInCanvasSettings.dy=n.offset,this.videoInCanvasSettings.dWidth=n.width,this.videoInCanvasSettings.dHeight=n.height):(n=this.getVideoInFaviconFit(o,i,t),this.videoInCanvasSettings.dx=n.offset,this.videoInCanvasSettings.dy=0,this.videoInCanvasSettings.dWidth=n.height,this.videoInCanvasSettings.dHeight=n.width)}},{key:"loadedmetadataHandler",value:function(){var e=0,t=0;this.mode.respectAspectRatio?(this.mode.calculateAndSetVideoInCanvasProfile(this.video,this.favicon.size),e=this.favicon.size,t=this.favicon.size):(e=this.video.videoWidth,t=this.video.videoHeight),this.canvas.width=e,this.canvas.height=t}},{key:"registerUpdateEvent",value:function(e){e.registerVideoEvent("loadedmetadata",this.loadedmetadataHandler.bind(e)),this.fps?this.interval=setInterval(e.update.bind(e),1e3/this.fps):e.registerVideoEvent("timeupdate",e.update.bind(e))}},{key:"disable",value:function(){clearTimeout(this.interval)}}])&&d(n.prototype,i),o&&d(n,o),t}((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));window.Favideo=u,window.FavideoModeVideo=l}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL0Zhdmljb24uanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0NhbnZhcy5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvRmF2aWRlby5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvRmF2aWRlb01vZGVWaWRlby5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvRmF2aWRlb01vZGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiRmF2aWNvbiIsImZhdmljb24iLCJleGlzdGluZ0Zhdmljb24iLCJ0aGlzIiwiZ2V0RXhpc3RpbmdGYXZpY29uIiwibm9kZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImxpbmsiLCJjcmVhdGVFbGVtZW50IiwidHlwZSIsInJlbCIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiYXBwZW5kQ2hpbGQiLCJ1cmwiLCJocmVmIiwic2l6ZSIsInNpemVfIiwic2l6ZXMiLCJDYW52YXMiLCJjYW52YXMiLCJjdHhfIiwiZ2V0Q29udGV4dCIsIndpZHRoIiwiaGVpZ2h0IiwiRmF2aWRlbyIsInZpZGVvIiwiZmF2aWNvblNpemUiLCJ2aWRlb0V2ZW50TGlzdGVuZXJzIiwiZW5hYmxlIiwiZnJhbWVVcmwiLCJnZXRGYXZpY29uRnJhbWUiLCJjdHgiLCJ1cGRhdGUiLCJyZWdpc3RlclVwZGF0ZUV2ZW50IiwidW5yZWdpc3RlclZpZGVvRXZlbnRzIiwiZGlzYWJsZSIsImV2ZW50IiwiZnVuYyIsInB1c2giLCJhZGRFdmVudExpc3RlbmVyIiwibGVuZ3RoIiwidmVsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIkZhdmlkZW9Nb2RlVmlkZW8iLCJyZXNwZWN0QXNwZWN0UmF0aW8iLCJmcHMiLCJ2aWRlb0luQ2FudmFzU2V0dGluZ3MiLCJkeCIsImR5IiwiZFdpZHRoIiwiZEhlaWdodCIsImNhbnZhc0N0eCIsImRyYXdJbWFnZSIsInRvRGF0YVVSTCIsImEiLCJiIiwiZmwiLCJhdl9oIiwib2Zmc2V0IiwidmlkZW9GaXQiLCJ2X3ciLCJ2aWRlb1dpZHRoIiwidl9oIiwidmlkZW9IZWlnaHQiLCJnZXRWaWRlb0luRmF2aWNvbkZpdCIsImNhbnZhc1dpZHRoIiwiY2FudmFzSGVpZ2h0IiwiY2FsY3VsYXRlQW5kU2V0VmlkZW9JbkNhbnZhc1Byb2ZpbGUiLCJmYXZpZGVvIiwicmVnaXN0ZXJWaWRlb0V2ZW50IiwibG9hZGVkbWV0YWRhdGFIYW5kbGVyIiwiaW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsImNsZWFyVGltZW91dCIsIndpbmRvdyJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixF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TUFBUTJDLEVBQ3BCL0QsS0FBS2lCLE9BQU9JLE9BQVMyQyxJQXJGN0IsMENBMkZ3QkUsR0FDaEJBLEVBQVFDLG1CQUFtQixpQkFBa0JuRSxLQUFLb0Usc0JBQXNCL0UsS0FBSzZFLElBQ3hFbEUsS0FBSzJDLElBR04zQyxLQUFLcUUsU0FBV0MsWUFBWUosRUFBUXBDLE9BQU96QyxLQUFLNkUsR0FBVSxJQUFLbEUsS0FBSzJDLEtBRnBFdUIsRUFBUUMsbUJBQW1CLGFBQWNELEVBQVFwQyxPQUFPekMsS0FBSzZFLE1BOUZ6RSxnQ0FxR1FLLGFBQWF2RSxLQUFLcUUsZSwyQkFyRzFCLElDRkEsYyw0RkFBQSxZQ0VBRyxPQUFPbEQsUUFBVUEsRUFDakJrRCxPQUFPL0IsaUJBQW1CQSIsImZpbGUiOiJmYXZpY29uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiZXhwb3J0IGNsYXNzIEZhdmljb24ge1xyXG4gICAgY29uc3RydWN0b3IoZmF2aWNvbikge1xyXG4gICAgICAgIGxldCBleGlzdGluZ0Zhdmljb24gPSB0aGlzLmdldEV4aXN0aW5nRmF2aWNvbigpO1xyXG4gICAgICAgIGlmICghZXhpc3RpbmdGYXZpY29uKSB7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZSA9IHRoaXMuY3JlYXRlKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5ub2RlID0gZXhpc3RpbmdGYXZpY29uO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldEV4aXN0aW5nRmF2aWNvbigpIHtcclxuICAgICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbGlua1tyZWw9XCJzaG9ydGN1dCBpY29uXCJdJyk7XHJcbiAgICB9XHJcbiAgICBjcmVhdGUoKSB7XHJcbiAgICAgICAgbGV0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJyk7XHJcbiAgICAgICAgbGluay50eXBlID0gJ2ltYWdlL3gtaWNvbic7XHJcbiAgICAgICAgbGluay5yZWwgPSAnc2hvcnRjdXQgaWNvbic7XHJcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXS5hcHBlbmRDaGlsZChsaW5rKTtcclxuICAgICAgICByZXR1cm4gbGluaztcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUodXJsKSB7XHJcbiAgICAgICAgdGhpcy5ocmVmID0gdXJsO1xyXG4gICAgfTtcclxuXHJcbiAgICBzZXQgaHJlZih1cmwpIHtcclxuICAgICAgICB0aGlzLm5vZGUuaHJlZiA9IHVybDtcclxuICAgIH1cclxuICAgIGdldCBocmVmKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5vZGUuaHJlZjtcclxuICAgIH1cclxuXHJcbiAgICBzZXQgc2l6ZShzaXplKSB7XHJcbiAgICAgICAgdGhpcy5zaXplXyA9IHNpemU7XHJcbiAgICAgICAgdGhpcy5ub2RlLnNpemVzID0gc2l6ZSArIFwieFwiICsgc2l6ZTtcclxuICAgIH1cclxuICAgIGdldCBzaXplKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNpemVfO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIENhbnZhcyB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XHJcbiAgICAgICAgdGhpcy5jdHhfID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgIH1cclxuICAgIGdldCBub2RlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNhbnZhcztcclxuICAgIH1cclxuICAgIGdldCBjdHgoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY3R4XztcclxuICAgIH1cclxuICAgIGdldCB3aWR0aCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5ub2RlLndpZHRoO1xyXG4gICAgfVxyXG4gICAgc2V0IHdpZHRoKHdpZHRoKSB7XHJcbiAgICAgICAgdGhpcy5ub2RlLndpZHRoID0gd2lkdGg7XHJcbiAgICB9XHJcbiAgICBnZXQgaGVpZ2h0KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm5vZGUud2lkdGg7XHJcbiAgICB9XHJcbiAgICBzZXQgaGVpZ2h0KGhlaWdodCkge1xyXG4gICAgICAgIHRoaXMubm9kZS5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQge0Zhdmljb259IGZyb20gXCIuL0Zhdmljb25cIjtcclxuaW1wb3J0IHtDYW52YXN9IGZyb20gXCIuL0NhbnZhc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEZhdmlkZW8ge1xyXG4gICAgY29uc3RydWN0b3IodmlkZW8sIG1vZGUsIGZhdmljb25TaXplKSB7XHJcbiAgICAgICAgdGhpcy52aWRlbyA9IHZpZGVvO1xyXG4gICAgICAgIHRoaXMubW9kZSA9IG1vZGU7XHJcbiAgICAgICAgdGhpcy5mYXZpY29uID0gbmV3IEZhdmljb24oKTtcclxuICAgICAgICB0aGlzLmZhdmljb24uc2l6ZSA9IGZhdmljb25TaXplO1xyXG4gICAgICAgIHRoaXMuY2FudmFzID0gbmV3IENhbnZhcygpO1xyXG4gICAgICAgIHRoaXMudmlkZW9FdmVudExpc3RlbmVycyA9IFtdO1xyXG4gICAgICAgIHRoaXMuZW5hYmxlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGZldGNoZXMgYW5kIHNldHMgdGhlIGZyYW1lIGZvciB0aGUgY29uZmlndXJlZCBGYXZpZGVvTW9kZS5cclxuICAgICAqL1xyXG4gICAgdXBkYXRlKCkge1xyXG4gICAgICAgIGxldCBmcmFtZVVybCA9IHRoaXMubW9kZS5nZXRGYXZpY29uRnJhbWUodGhpcy52aWRlbywgdGhpcy5jYW52YXMubm9kZSwgdGhpcy5jYW52YXMuY3R4KTtcclxuICAgICAgICB0aGlzLmZhdmljb24udXBkYXRlKGZyYW1lVXJsKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIHJlZ2lzdGVycyB0aGUgdXBkYXRlIGV2ZW50IGZvciB0aGUgY29uZmlndXJlZCBGYXZpZGVvTW9kZS5cclxuICAgICAqL1xyXG4gICAgZW5hYmxlKCkge1xyXG4gICAgICAgIHRoaXMubW9kZS5yZWdpc3RlclVwZGF0ZUV2ZW50KHRoaXMpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgZnVuY3Rpb24gdW5yZWdpc3RlcnMgdGhlIHVwZGF0ZSBldmVudCBmb3IgdGhlIGNvbmZpZ3VyZWQgRmF2aWRlb01vZGUuXHJcbiAgICAgKi9cclxuICAgIGRpc2FibGUoKSB7XHJcbiAgICAgICAgdGhpcy51bnJlZ2lzdGVyVmlkZW9FdmVudHMoKTtcclxuICAgICAgICB0aGlzLm1vZGUuZGlzYWJsZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiByZWdpc3RlcnMgYW5kIGF0dGFjaGVzIGEgdmlkZW8gZXZlbnQgaGFuZGxlci5cclxuICAgICAqIEBwYXJhbSBldmVudFxyXG4gICAgICogQHBhcmFtIGZ1bmNcclxuICAgICAqL1xyXG4gICAgcmVnaXN0ZXJWaWRlb0V2ZW50KGV2ZW50LCBmdW5jKSB7XHJcbiAgICAgICAgdGhpcy52aWRlb0V2ZW50TGlzdGVuZXJzLnB1c2goe2V2ZW50OiBldmVudCwgZnVuYzogZnVuY30pO1xyXG4gICAgICAgIHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgZnVuYyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIHVucmVnaXN0ZXJzIGFsbCB2aWRlbyBldmVudCBoYW5kbGVycy5cclxuICAgICAqL1xyXG4gICAgdW5yZWdpc3RlclZpZGVvRXZlbnRzKCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy52aWRlb0V2ZW50TGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCB2ZWwgPSB0aGlzLnZpZGVvRXZlbnRMaXN0ZW5lcnNbaV07XHJcbiAgICAgICAgICAgIHRoaXMudmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcih2ZWwuZXZlbnQsIHZlbC5mdW5jKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQge0ZhdmlkZW9Nb2RlfSBmcm9tIFwiLi9GYXZpZGVvTW9kZVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEZhdmlkZW9Nb2RlVmlkZW8gZXh0ZW5kcyBGYXZpZGVvTW9kZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihyZXNwZWN0QXNwZWN0UmF0aW8sIGZwcykge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5yZXNwZWN0QXNwZWN0UmF0aW8gPSByZXNwZWN0QXNwZWN0UmF0aW87XHJcbiAgICAgICAgdGhpcy5mcHMgPSBmcHM7XHJcbiAgICAgICAgdGhpcy52aWRlb0luQ2FudmFzU2V0dGluZ3MgPSB7XHJcbiAgICAgICAgICAgIGR4OiAwLCBkeTogMCwgZFdpZHRoOiAwLCBkSGVpZ2h0OiAwXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiByZXR1cm5zIHRoZSB0byBiZSByZW5kZXJlZCBmcmFtZSBmb3IgRmF2aWRlb01vZGVWaWRlby5cclxuICAgICAqIEBwYXJhbSB2aWRlb1xyXG4gICAgICogQHBhcmFtIGNhbnZhc1xyXG4gICAgICogQHBhcmFtIGNhbnZhc0N0eFxyXG4gICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAqL1xyXG4gICAgZ2V0RmF2aWNvbkZyYW1lKHZpZGVvLCBjYW52YXMsIGNhbnZhc0N0eCkge1xyXG4gICAgICAgIGlmICh0aGlzLnJlc3BlY3RBc3BlY3RSYXRpbykge1xyXG4gICAgICAgICAgICBjYW52YXNDdHguZHJhd0ltYWdlKHZpZGVvLCB0aGlzLnZpZGVvSW5DYW52YXNTZXR0aW5ncy5keCwgdGhpcy52aWRlb0luQ2FudmFzU2V0dGluZ3MuZHksIHRoaXMudmlkZW9JbkNhbnZhc1NldHRpbmdzLmRXaWR0aCwgdGhpcy52aWRlb0luQ2FudmFzU2V0dGluZ3MuZEhlaWdodCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY2FudmFzQ3R4LmRyYXdJbWFnZSh2aWRlbywgMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGNhbnZhcy50b0RhdGFVUkwoKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIG1lYXN1cmVzIHRoZSBuZXcgdmlkZW8gcHJvZmlsZSBpbnNpZGUgb2YgdGhlIGZhdmljb24uXHJcbiAgICAgKiBAcGFyYW0gYTogbWF4KHZpZGVvV2lkdGgsIHZpZGVvSGVpZ2h0KVxyXG4gICAgICogQHBhcmFtIGI6IG1pbih2aWRlb1dpZHRoLCB2aWRlb0hlaWdodClcclxuICAgICAqIEBwYXJhbSBmbDogZmF2aWNvbiBsZW5ndGhcclxuICAgICAqIEByZXR1cm5zIHt7b2Zmc2V0OiBudW1iZXIsIHdpZHRoOiAqLCBoZWlnaHQ6IG51bWJlcn19XHJcbiAgICAgKi9cclxuICAgIGdldFZpZGVvSW5GYXZpY29uRml0KGEsIGIsIGZsKSB7XHJcbiAgICAgICAgbGV0IHggPSBhL2ZsO1xyXG4gICAgICAgIGxldCBhdl93ID0gZmw7XHJcbiAgICAgICAgbGV0IGF2X2ggPSBiL3g7XHJcbiAgICAgICAgbGV0IG9fdCA9IChmbC1hdl9oKS8yO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHdpZHRoOiBhdl93LFxyXG4gICAgICAgICAgICBoZWlnaHQ6IGF2X2gsXHJcbiAgICAgICAgICAgIG9mZnNldDogb190XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgZnVuY3Rpb24gY2hlY2tzIHRvIHdoYXQgdGhlIHZpZGVvIG5lZWRzIHRvIGJlIHNjYWxlZCB0byBmaXQgaW50byB0aGUgZmF2aWNvbixcclxuICAgICAqIGlmIHRoZSBhc3BlY3QgcmF0aW8gaXMgdG8gYmUgcmVzcGVjdGVkLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB2aWRlb1xyXG4gICAgICogQHBhcmFtIGZhdmljb25TaXplXHJcbiAgICAgKi9cclxuICAgIGNhbGN1bGF0ZUFuZFNldFZpZGVvSW5DYW52YXNQcm9maWxlKHZpZGVvLCBmYXZpY29uU2l6ZSkge1xyXG4gICAgICAgIGxldCB2X3cgPSB2aWRlby52aWRlb1dpZHRoLCB2X2ggPSB2aWRlby52aWRlb0hlaWdodDtcclxuICAgICAgICBsZXQgdmlkZW9GaXQ7XHJcbiAgICAgICAgaWYgKHZfdyA+IHZfaCkge1xyXG4gICAgICAgICAgICB2aWRlb0ZpdCA9IHRoaXMuZ2V0VmlkZW9JbkZhdmljb25GaXQodl93LCB2X2gsIGZhdmljb25TaXplKTtcclxuICAgICAgICAgICAgdGhpcy52aWRlb0luQ2FudmFzU2V0dGluZ3MuZHggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnZpZGVvSW5DYW52YXNTZXR0aW5ncy5keSA9IHZpZGVvRml0Lm9mZnNldDtcclxuICAgICAgICAgICAgdGhpcy52aWRlb0luQ2FudmFzU2V0dGluZ3MuZFdpZHRoID0gdmlkZW9GaXQud2lkdGg7XHJcbiAgICAgICAgICAgIHRoaXMudmlkZW9JbkNhbnZhc1NldHRpbmdzLmRIZWlnaHQgPSB2aWRlb0ZpdC5oZWlnaHQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdmlkZW9GaXQgPSB0aGlzLmdldFZpZGVvSW5GYXZpY29uRml0KHZfaCwgdl93LCBmYXZpY29uU2l6ZSk7XHJcbiAgICAgICAgICAgIHRoaXMudmlkZW9JbkNhbnZhc1NldHRpbmdzLmR4ID0gIHZpZGVvRml0Lm9mZnNldDtcclxuICAgICAgICAgICAgdGhpcy52aWRlb0luQ2FudmFzU2V0dGluZ3MuZHkgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnZpZGVvSW5DYW52YXNTZXR0aW5ncy5kV2lkdGggPSB2aWRlb0ZpdC5oZWlnaHQ7XHJcbiAgICAgICAgICAgIHRoaXMudmlkZW9JbkNhbnZhc1NldHRpbmdzLmRIZWlnaHQgPSB2aWRlb0ZpdC53aWR0aDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBldmVudCBoYW5kbGVyIHVwZGF0ZXMgdGhlIGNhbnZhcyB3aWR0aCBhbmQgaGVpZ2h0LFxyXG4gICAgICogYmVjYXVzZSB0aGUgdmlkZW8gd2lkdGggYW5kIGhlaWdodCBhcmUgbm93IGtub3duLlxyXG4gICAgICovXHJcbiAgICBsb2FkZWRtZXRhZGF0YUhhbmRsZXIoKSB7XHJcbiAgICAgICAgbGV0IGNhbnZhc1dpZHRoID0gMCwgY2FudmFzSGVpZ2h0ID0gMDtcclxuICAgICAgICBpZiAodGhpcy5tb2RlLnJlc3BlY3RBc3BlY3RSYXRpbykge1xyXG4gICAgICAgICAgICB0aGlzLm1vZGUuY2FsY3VsYXRlQW5kU2V0VmlkZW9JbkNhbnZhc1Byb2ZpbGUodGhpcy52aWRlbywgdGhpcy5mYXZpY29uLnNpemUpO1xyXG4gICAgICAgICAgICBjYW52YXNXaWR0aCA9IHRoaXMuZmF2aWNvbi5zaXplO1xyXG4gICAgICAgICAgICBjYW52YXNIZWlnaHQgPSB0aGlzLmZhdmljb24uc2l6ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjYW52YXNXaWR0aCA9IHRoaXMudmlkZW8udmlkZW9XaWR0aDtcclxuICAgICAgICAgICAgY2FudmFzSGVpZ2h0ID0gdGhpcy52aWRlby52aWRlb0hlaWdodDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSBjYW52YXNXaWR0aDtcclxuICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSBjYW52YXNIZWlnaHQ7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiByZWdpc3RlcnMgdGhlIHVwZGF0ZSBldmVudCBvZiBGYXZpZGVvTW9kZVZpZGVvLlxyXG4gICAgICovXHJcbiAgICByZWdpc3RlclVwZGF0ZUV2ZW50KGZhdmlkZW8pIHtcclxuICAgICAgICBmYXZpZGVvLnJlZ2lzdGVyVmlkZW9FdmVudCgnbG9hZGVkbWV0YWRhdGEnLCB0aGlzLmxvYWRlZG1ldGFkYXRhSGFuZGxlci5iaW5kKGZhdmlkZW8pKTtcclxuICAgICAgICBpZiAoIXRoaXMuZnBzKSB7XHJcbiAgICAgICAgICAgIGZhdmlkZW8ucmVnaXN0ZXJWaWRlb0V2ZW50KCd0aW1ldXBkYXRlJywgZmF2aWRlby51cGRhdGUuYmluZChmYXZpZGVvKSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmludGVydmFsID0gc2V0SW50ZXJ2YWwoZmF2aWRlby51cGRhdGUuYmluZChmYXZpZGVvKSwgMTAwMC90aGlzLmZwcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGRpc2FibGUoKSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuaW50ZXJ2YWwpO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIEZhdmlkZW9Nb2RlIHtcclxuXHJcbn0iLCJpbXBvcnQge0ZhdmlkZW99IGZyb20gJy4vRmF2aWRlbyc7XHJcbmltcG9ydCB7RmF2aWRlb01vZGVWaWRlb30gZnJvbSBcIi4vRmF2aWRlb01vZGVWaWRlb1wiO1xyXG53aW5kb3cuRmF2aWRlbyA9IEZhdmlkZW87XHJcbndpbmRvdy5GYXZpZGVvTW9kZVZpZGVvID0gRmF2aWRlb01vZGVWaWRlbzsiXSwic291cmNlUm9vdCI6IiJ9